import fsx from "fs-extra";
import mustache from "mustache";

const generator = require("../package.json");

// disabling escape
mustache.escape = (s) => s;

export const BANNER = `/**
* @generated by ${generator.name}; do not modify manually!
*/`;

export async function render<Context = {}>(
  template: string,
  context: Context,
): Promise<string> {
  return mustache.render(template, context);
}

export async function renderToFile<Context = {}>(
  file: string,
  template: string,
  context: Context,
): Promise<void> {
  return fsx.outputFile(file, await render(template, context), "utf8");
}
